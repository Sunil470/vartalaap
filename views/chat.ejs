<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <title>EKCS - Chat Box</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" href="./style.css">

</head>
<body>
<!-- partial:index.partial.html -->
<div class="flexbox">
  <div class="chat-box">
    <div class="chat-box-header">
      <h3>Some Chat Room<br /><small>Last active: 0 min ago</small></h3>
    </div>
    <div id="chat_box_body" class="chat-box-body">
      <div id="chat_messages">
        
        
       
      </div>
    </div>
    <div id="typing">
      <div><span></span> <span></span> <span></span> <span class="n">Someone</span> is typing...</div>
    </div>
    <div class="chat-box-footer">
      <textarea id="chatBox" placeholder="Enter your message here..."></textarea>
      <button onclick="send()" id="send">
        <svg style="width:24px;height:24px" viewBox="0 0 24 24">
          <path fill="#006ae3" d="M2,21L23,12L2,3V10L17,12L2,14V21Z" />
        </svg>
      </button>
    </div>
  </div>
</div>
<!-- partial -->
  <!-- <script  src="./script.js"></script> -->
  <script>
           
    let ws = new WebSocket("ws://localhost:2000")
    ws.onmessage = function(msg)
    {
       document.getElementById("chat_messages").innerHTML += `<div class="profile other-profile">
          <img src="https://images.unsplash.com/photo-1537396123722-b93d0acd8848?ixlib=rb-0.3.5&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=400&fit=max&ixid=eyJhcHBfaWQiOjE0NTg5fQ&s=efc6e85c24d3cfdd15cd36cb8a2471ed" width="30" height="30" />
          <span>${name.data}</span>
        </div>
        <div id="other_chat" class="message other-message">
          ${msg.data}
        </div>`
       
    }


   function send()
   { 
        let msg = document.getElementById("chatBox").value
        let name = localStorage.getItem("name")
        
        //let cmp_msg = "<strong>" + name + ": </strong>" + msg
        
        ws.send(msg, name)
        document.getElementById("chat_messages").innerHTML += `<div class="profile my-profile">
          <span id="user_name">${name}</span>
          <img src="https://images.unsplash.com/photo-1534135954997-e58fbd6dbbfc?ixlib=rb-0.3.5&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=400&fit=max&ixid=eyJhcHBfaWQiOjE0NTg5fQ&s=02d536c38d9cfeb4f35f17fdfaa36619" width="30" height="30" />
        </div>
        <div id="my_chat" class="message my-message">
          ${msg}
        </div>`
   } 






</script>









<script>
 let name = localStorage.getItem("name")
 if(!name)
 {
     window.location.href = "/home.html"
 }
</script>

</body>
</html>
